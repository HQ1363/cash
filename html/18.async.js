(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{R9X0:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var m=l(a("BMrR"));a("jCWc");var r=l(a("kPKH"));a("2qtc");var i=l(a("kLXV"));a("/zsF");var o=l(a("PArb"));a("+L6B");var c=l(a("2/Rp"));a("y8nQ");var s=l(a("Vl3Y"));a("Mwp2");var d=l(a("VXEj"));a("i5XK");var u=l(a("jq9l"));a("Pwec");var h=l(a("CtXQ"));a("5NDa");var f,p,C=l(a("5rEg")),y=n(a("q1tI")),g=a("MuoO"),v=l(a("bnNk")),E=l(a("XfOM")),b=l(a("mOP9")),_=a("+n12"),R=l(a("DlQD")),k=l(a("FIf5"));a("nyGS");var S=C.default.TextArea;R.default.setOptions({highlight:e=>k.default.highlightAuto(e).value});var D=e=>{var t=e.type,a=e.text,l=e.theme;return y.default.createElement("span",null,y.default.createElement(h.default,{type:t,theme:l,style:{marginRight:8}}),a)},N=e=>{var t=e.comment,a=e.handleReplyComment;return y.default.createElement(u.default,{actions:[y.default.createElement("span",{onClick:()=>a(t)},"\u56de\u590d")],author:t["account"]["nick_name"],avatar:`/media/${t["account"]["avatar"]}`,content:t["content"],datetime:(0,_.formatDateTime)(t["ct"])},t["children"]&&t["children"].length>0?t["children"].map(e=>y.default.createElement(N,{handleReplyComment:a,key:e["id"],comment:e})):y.default.createElement(y.Fragment,null))},w=e=>{var t=e.comments,a=e.handleReplyComment;return y.default.createElement(d.default,{dataSource:t,header:`${t.length} \u8bc4\u8bba`,itemLayout:"horizontal",renderItem:e=>y.default.createElement(N,{handleReplyComment:a,key:e["id"],comment:e})})},F=e=>{var t=e.onChange,a=e.onSubmit,l=e.submitting,n=e.value;return y.default.createElement("div",null,y.default.createElement(s.default.Item,null,y.default.createElement(S,{rows:4,onChange:t,value:n})),y.default.createElement(s.default.Item,null,y.default.createElement(c.default,{htmlType:"submit",loading:l,onClick:a,type:"primary"},"\u6dfb\u52a0\u8bc4\u8bba")))},M=(f=(0,g.connect)(e=>{var t=e.articleDetail;return{articleDetail:t}}),f(p=class extends y.Component{constructor(){super(...arguments),this.state={submitting:!1,commentContent:"",replyCommentContent:"",replyCommentisible:!1,comment:{}},this.handleSubmit=(()=>{if(this.state.commentContent){var e=this.props.dispatch;this.setState({submitting:!0}),e({type:"articleDetail/createComment",payload:{content:this.state.commentContent},callback:()=>{this.setState({submitting:!1,commentContent:""})}})}}),this.handleChange=(e=>{this.setState({commentContent:e.target.value})}),this.handleReplyComment=(e=>{this.setState({replyCommentisible:!this.state.replyCommentisible,comment:e})}),this.handleReplyCommentChange=(e=>{this.setState({replyCommentContent:e.target.value})}),this.handleSubmitReplyComment=(()=>{if(this.state.replyCommentContent){var e=this.props.dispatch;this.setState({submitting:!0}),e({type:"articleDetail/createComment",payload:{reply:this.state.comment.id,content:this.state.replyCommentContent},callback:()=>{this.setState({replyCommentisible:!1,replyCommentContent:"",comment:""})}})}})}componentDidMount(){var e=this.props,t=e.dispatch,a=e.match,l=a.params.url;t({type:"articleDetail/get",payload:l}),t({type:"articleDetail/getComments",payload:l})}render(){var e=this.props.articleDetail,t=e.article,a=e.comments,l=this.state,n=l.submitting,c=l.commentContent,s=l.replyCommentContent,d=t["content"]?(0,R.default)(t["content"]):"";return y.default.createElement(m.default,{gutter:8},y.default.createElement(r.default,{span:17},y.default.createElement("div",{className:v.default.detail},y.default.createElement("h1",{className:v.default.title},t["title"]),y.default.createElement("div",{className:v.default.articleFooter},y.default.createElement("span",null,(0,_.formatDate)(t["release_time"])),y.default.createElement("span",{className:E.default.dot}),y.default.createElement(D,{type:"eye",theme:"filled",text:t["view_count"]}),y.default.createElement("span",{className:E.default.dot}),y.default.createElement("a",{href:"#comment"},y.default.createElement(D,{type:"message",theme:"filled",text:t["comment_count"]})),t.tags?y.default.createElement(y.Fragment,null,y.default.createElement("span",{className:E.default.dot}),t.tags.map(e=>y.default.createElement(b.default,{className:E.default.tagLink,key:e,to:`/tag/${e}`},e))):y.default.createElement(y.Fragment,null)),y.default.createElement(o.default,null),y.default.createElement("div",{dangerouslySetInnerHTML:{__html:d}})),y.default.createElement("div",{id:"comment",className:v.default.comment},a.length>0&&y.default.createElement(w,{handleReplyComment:this.handleReplyComment,comments:a}),y.default.createElement(u.default,{content:y.default.createElement(F,{onChange:this.handleChange,onSubmit:this.handleSubmit,submitting:n,value:c})}),y.default.createElement(i.default,{closable:!1,visible:this.state.replyCommentisible,onOk:this.handleSubmitReplyComment,onCancel:()=>this.handleReplyComment({})},y.default.createElement(S,{rows:4,onChange:this.handleReplyCommentChange,value:s})))))}})||p),x=M;t.default=x},bnNk:function(e,t,a){e.exports={detail:"detail___2aRzU",title:"title___1JNLJ",articleFooter:"articleFooter___2Tnpf",comment:"comment___15N71"}}}]);